package section8CartForProductOrder;

import java.time.Duration;
import java.util.Arrays;
import java.util.List;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.Wait;
import org.openqa.selenium.support.ui.WebDriverWait;

public class AddProductsToCartUsingMethodAndWaitMechanism {

	public static void main(String[] args)  {
		// TODO Auto-generated method stub

		
		String[] ItemsNeeded = {"Cauliflower", "Cucumber","Apple", "Almonds" };
		WebDriver driver = new ChromeDriver();
	
		//driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(5000));
		AddProductsToCartUsingMethodAndWaitMechanism obj = new AddProductsToCartUsingMethodAndWaitMechanism();
		obj.AddItemsToCart(driver, ItemsNeeded);
		WebDriverWait waitobj = new WebDriverWait(driver, Duration.ofSeconds(5));
		driver.findElement(By.cssSelector(".cart-icon")).click();
	    driver.findElement(By.xpath("//button[text()='PROCEED TO CHECKOUT']")).click();
	    waitobj.until(ExpectedConditions.visibilityOfElementLocated(By.cssSelector(".promoCode")));
	    driver.findElement(By.cssSelector(".promoCode")).sendKeys("rahulshettyacademy");
	    driver.findElement(By.cssSelector(".promoBtn")).click();
	    waitobj.until(ExpectedConditions.visibilityOfElementLocated(By.cssSelector(".promoInfo")));
	    System.out.println(driver.findElement(By.cssSelector(".promoInfo")).getText());
	    driver.findElement(By.xpath("//button[contains(text(),'Place Order')]")).click();
	    Select obj2 =new Select(driver.findElement(By.xpath("//div/select")));
	    obj2.selectByValue("Bosnia &amp; Herzegovina");
	    driver.findElement(By.cssSelector(".chkAgree")).click();
	    driver.findElement(By.xpath("//button[text()='Proceed']")).click();
	}
	
	public void AddItemsToCart(WebDriver driver,String[] ItemsNeeded ) 
	{
		int j=0;
		driver.get("https://rahulshettyacademy.com/seleniumPractise/#/");
		List <WebElement> Items = driver.findElements(By.cssSelector("h4.product-name"));
		
		
		for (int i=0;i<Items.size();i++)
		{
			String[] SinglItem = Items.get(i).getText().split("-");
			String Product = SinglItem[0].trim();
			List AytoAyList = Arrays.asList(ItemsNeeded);
			if (AytoAyList.contains(Product))
			{
				driver.findElements(By.xpath("//button[text()='ADD TO CART']")).get(i).click();//get(i) with find elements too imp
				j++;//If we don't want to run code again after respective items gets added to cart
				if (j==4)
				{
					break;
				}
			}
			
		}
		
		
	    
	    
	}

}
/*
 *    Syntax for Explicit wait 
 *    WebDriverWait WaitObj = new WebDriverWait(driver, n);// deprecated now
 *    WebDriverWait WaitObj = new WebDriverWait(driver, Duration.ofSeconds(5));
 *    
 
*/
